<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Opulence | Gestion Restaurant Premium</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: #0F0F11;
            color: #E4E4E7;
            overflow-x: hidden;
        }
        .glass {
            background: rgba(26, 26, 29, 0.85);
            backdrop-filter: blur(14px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        .sidebar-item.active {
            background: linear-gradient(90deg, rgba(225, 29, 72, 0.15) 0%, transparent 100%);
            border-left: 4px solid #E11D48;
            color: white;
        }
        .custom-scrollbar::-webkit-scrollbar {
            width: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #27272A;
            border-radius: 10px;
        }
        .product-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .product-card:hover {
            transform: translateY(-5px);
            border-color: rgba(225, 29, 72, 0.3);
        }
        @media (max-width: 1024px) {
            .mobile-sidebar-hidden { transform: translateX(-100%); }
            .mobile-sidebar-show { transform: translateX(0); }
        }
    </style>
</head>
<body class="custom-scrollbar">

<div id="app">
    <!-- ECRAN DE CONNEXION -->
    <div id="login-screen" class="min-h-screen w-full flex items-center justify-center relative transition-opacity duration-500">
        <div class="absolute inset-0 z-0">
            <img src="https://images.unsplash.com/photo-1555396273-367ea4eb4db5?auto=format&fit=crop&w=1920&q=80" class="w-full h-full object-cover opacity-20" alt="Restaurant Background">
            <div class="absolute inset-0 bg-gradient-to-b from-black/80 to-[#0F0F11]"></div>
        </div>
        
        <div class="relative z-10 w-full max-w-md p-8 glass rounded-[2.5rem] shadow-2xl mx-4">
            <div class="text-center mb-10">
                <div class="w-20 h-20 bg-rose-600 rounded-full flex items-center justify-center mx-auto mb-6 shadow-xl shadow-rose-600/40">
                    <span class="text-4xl font-bold italic text-white">O</span>
                </div>
                <h1 class="text-4xl font-extrabold tracking-tight text-white">Opulence</h1>
                <p class="text-zinc-500 mt-2 font-medium">Gestion & Commande de Luxe</p>
            </div>

            <form onsubmit="handleLogin(event)" class="space-y-6">
                <div>
                    <label class="block text-sm font-semibold text-zinc-400 mb-2">Identifiant</label>
                    <input type="text" id="username" class="w-full bg-zinc-900/80 border border-zinc-800 rounded-2xl py-4 px-5 focus:outline-none focus:border-rose-600 text-white transition-all placeholder-zinc-700" placeholder="admin ou laisser vide">
                </div>
                <div>
                    <label class="block text-sm font-semibold text-zinc-400 mb-2">Mot de passe</label>
                    <input type="password" id="password" class="w-full bg-zinc-900/80 border border-zinc-800 rounded-2xl py-4 px-5 focus:outline-none focus:border-rose-600 text-white transition-all placeholder-zinc-700" placeholder="1234 ou laisser vide">
                </div>
                <button type="submit" class="w-full bg-rose-600 hover:bg-rose-700 text-white font-bold py-4 rounded-2xl shadow-lg shadow-rose-600/20 transform transition active:scale-95">
                    Entrer dans l'établissement
                </button>
            </form>
            <div class="mt-8 text-center">
                <p class="text-zinc-500 text-xs font-medium uppercase tracking-widest">Accès rapide</p>
                <div class="flex justify-center gap-4 mt-3">
                    <button onclick="quickFill('admin')" class="text-[10px] bg-zinc-800 hover:bg-zinc-700 px-3 py-1 rounded-full text-zinc-400">Mode Admin</button>
                    <button onclick="quickFill('')" class="text-[10px] bg-zinc-800 hover:bg-zinc-700 px-3 py-1 rounded-full text-zinc-400">Mode Visiteur</button>
                </div>
            </div>
        </div>
    </div>

    <!-- INTERFACE PRINCIPALE -->
    <div id="main-layout" class="hidden h-screen flex flex-col lg:flex-row overflow-hidden">
        
        <!-- Sidebar Mobile Overlay -->
        <div id="sidebar-overlay" onclick="toggleSidebar()" class="fixed inset-0 bg-black/60 z-40 lg:hidden hidden"></div>

        <!-- Sidebar -->
        <aside id="sidebar" class="fixed lg:relative inset-y-0 left-0 w-72 glass border-r border-zinc-800 flex flex-col z-50 transition-transform duration-300 mobile-sidebar-hidden lg:translate-x-0">
            <div class="p-8 flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-rose-600 rounded-full flex items-center justify-center font-bold italic text-white">O</div>
                    <span class="text-xl font-bold tracking-tighter text-white">OPULENCE</span>
                </div>
                <button onclick="toggleSidebar()" class="lg:hidden text-zinc-400 hover:text-white">
                    <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg>
                </button>
            </div>

            <nav id="nav-menu" class="flex-1 px-4 space-y-2 mt-4 overflow-y-auto custom-scrollbar">
                <!-- Dynamique via JS -->
            </nav>

            <div class="p-6 border-t border-zinc-800">
                <div class="flex items-center justify-between group cursor-pointer" onclick="logout()">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 rounded-xl bg-rose-600/10 flex items-center justify-center text-rose-500 group-hover:bg-rose-600 group-hover:text-white transition-all">
                            <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
                        </div>
                        <span class="font-bold text-sm text-zinc-400 group-hover:text-white">Déconnexion</span>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Content Area -->
        <main class="flex-1 flex flex-col overflow-hidden">
            <!-- Header -->
            <header class="h-20 flex items-center justify-between px-6 lg:px-10 bg-[#0F0F11]/90 backdrop-blur-md border-b border-zinc-900 shrink-0 z-30">
                <div class="flex items-center space-x-4">
                    <button onclick="toggleSidebar()" class="lg:hidden p-2 bg-zinc-900 rounded-xl text-zinc-400">
                        <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
                    </button>
                    <h2 id="page-title" class="text-xl lg:text-2xl font-bold text-white">Menu</h2>
                </div>
                
                <div class="flex items-center space-x-4 lg:space-x-8">
                    <div class="hidden sm:block relative">
                        <input type="text" onkeyup="searchItems(this.value)" placeholder="Rechercher..." class="bg-zinc-900/50 border border-zinc-800 rounded-2xl py-2 px-10 text-sm focus:outline-none focus:border-rose-600 w-48 lg:w-64 transition-all">
                        <svg class="absolute left-3 top-2.5 text-zinc-600" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
                    </div>
                    
                    <div class="flex items-center space-x-3">
                        <div class="hidden md:block text-right leading-none">
                            <p id="user-display-name" class="text-sm font-bold text-white">Visiteur</p>
                            <span id="user-role-label" class="text-[9px] text-zinc-500 uppercase tracking-widest font-bold">Client</span>
                        </div>
                        <div class="w-11 h-11 rounded-2xl bg-zinc-900 border border-zinc-800 overflow-hidden shadow-inner">
                            <img id="user-avatar" src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="Avatar">
                        </div>
                    </div>
                </div>
            </header>

            <!-- Scrollable Content -->
            <div id="content-display" class="flex-1 overflow-y-auto p-6 lg:p-10 custom-scrollbar relative bg-[#0F0F11]">
                <!-- Contenu via JS -->
            </div>
        </main>

        <!-- Right Panel (Cart or Stats) -->
        <aside id="right-panel" class="hidden xl:flex w-80 glass border-l border-zinc-800 p-8 flex flex-col shrink-0">
            <!-- Contenu via JS -->
        </aside>

        <!-- Mobile Cart FAB (Only for visitor) -->
        <button id="mobile-cart-btn" onclick="toggleMobileCart()" class="fixed bottom-6 right-6 w-16 h-16 bg-rose-600 rounded-full shadow-2xl shadow-rose-600/40 flex items-center justify-center z-40 lg:hidden hidden text-white">
            <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>
            <span id="cart-count-badge" class="absolute -top-1 -right-1 bg-white text-rose-600 text-[10px] font-black w-6 h-6 rounded-full flex items-center justify-center border-2 border-rose-600">0</span>
        </button>
    </div>

    <!-- Mobile Cart Drawer -->
    <div id="mobile-cart-drawer" class="fixed inset-0 z-[100] translate-x-full transition-transform duration-300 lg:hidden">
        <div class="absolute inset-0 bg-black/60" onclick="toggleMobileCart()"></div>
        <div class="absolute right-0 top-0 bottom-0 w-[85%] max-w-sm glass flex flex-col p-6 shadow-2xl">
            <div class="flex items-center justify-between mb-8">
                <h3 class="text-xl font-bold text-white">Votre Panier</h3>
                <button onclick="toggleMobileCart()" class="text-zinc-500"><svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg></button>
            </div>
            <div id="mobile-cart-list" class="flex-1 overflow-y-auto custom-scrollbar space-y-4"></div>
            <div id="mobile-cart-footer" class="pt-6 border-t border-zinc-800 mt-4"></div>
        </div>
    </div>
</div>

<script>
    // --- STATE ---
    let currentUser = null;
    let currentTab = 'home';
    let cart = [];
    let currentCategory = 'all';
    let searchQuery = '';

    const menuData = [
        { id: 1, name: "Burger Opulence", price: 24.00, type: "repas", image: "https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=400", stock: 12, desc: "Bœuf Wagyu, truffe noire et cheddar affiné 24 mois." },
        { id: 2, name: "Pizza Royale Truffe", price: 32.50, type: "repas", image: "https://images.unsplash.com/photo-1513104890138-7c749659a591?w=400", stock: 5, desc: "Base crème, truffe fraîche, burrata crémeuse." },
        { id: 3, name: "Cocktail Gold", price: 18.00, type: "boisson", image: "https://images.unsplash.com/photo-1514362545857-3bc16c4c7d1b?w=400", stock: 45, desc: "Gin premium, feuille d'or, essence de rose." },
        { id: 4, name: "Fondant Valrhona", price: 14.00, type: "dessert", image: "https://images.unsplash.com/photo-1624353365286-3f8d62daad51?w=400", stock: 10, desc: "Cœur coulant chocolat noir 70%, glace vanille." },
        { id: 5, name: "Salade Impériale", price: 21.00, type: "repas", image: "https://images.unsplash.com/photo-1550304943-4f24f54ddde9?w=400", stock: 18, desc: "Gambas grillées, avocat, sauce yuzu." },
        { id: 6, name: "Nectar d'Hibiscus", price: 9.00, type: "boisson", image: "https://images.unsplash.com/photo-1513558161293-cdaf765ed2fd?w=400", stock: 80, desc: "Infusion de fleurs d'hibiscus, menthe fraîche." }
    ];

    let orders = [
        { id: "#OP-8821", customer: "Ibrahim Sall", items: "Burger Opulence x2", total: 48.00, status: "en cours", time: "14:15" },
        { id: "#OP-8820", customer: "Amine K.", items: "Salade Impériale x1", total: 21.00, status: "terminé", time: "13:30" }
    ];

    // --- CORE FUNCTIONS ---

    function quickFill(role) {
        document.getElementById('username').value = role;
        document.getElementById('password').value = role === 'admin' ? '1234' : '';
    }

    function handleLogin(e) {
        e.preventDefault();
        const u = document.getElementById('username').value;
        const p = document.getElementById('password').value;

        if (u === 'admin' && p === '1234') {
            currentUser = 'admin';
        } else if (u === '' && p === '') {
            currentUser = 'visitor';
        } else {
            alert("Accès refusé. Utilisez admin/1234 ou laissez vide.");
            return;
        }

        document.getElementById('login-screen').classList.add('hidden');
        document.getElementById('main-layout').classList.remove('hidden');
        initApp();
    }

    function logout() {
        if(!confirm("Voulez-vous vraiment quitter l'établissement ?")) return;
        currentUser = null;
        cart = [];
        document.getElementById('login-screen').classList.remove('hidden');
        document.getElementById('main-layout').classList.add('hidden');
    }

    function initApp() {
        const nav = document.getElementById('nav-menu');
        const userLabel = document.getElementById('user-role-label');
        const userName = document.getElementById('user-display-name');
        const userAvatar = document.getElementById('user-avatar');
        const mobileBtn = document.getElementById('mobile-cart-btn');

        if (currentUser === 'admin') {
            userName.innerText = "Directeur Opulence";
            userLabel.innerText = "Administrateur";
            userAvatar.src = "https://api.dicebear.com/7.x/avataaars/svg?seed=Admin";
            mobileBtn.classList.add('hidden');
            nav.innerHTML = `
                <div onclick="navigate('admin-dash')" class="nav-btn sidebar-item flex items-center space-x-3 px-4 py-3 rounded-2xl cursor-pointer text-zinc-400">
                    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
                    <span class="font-bold text-sm">Tableau de Bord</span>
                </div>
                <div onclick="navigate('admin-inv')" class="nav-btn sidebar-item flex items-center space-x-3 px-4 py-3 rounded-2xl cursor-pointer text-zinc-400">
                    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 8V21H3V8"/><path d="M1 3H23V8H1V3Z"/><path d="M10 12H14"/></svg>
                    <span class="font-bold text-sm">Inventaire</span>
                </div>
                <div onclick="navigate('admin-orders')" class="nav-btn sidebar-item flex items-center space-x-3 px-4 py-3 rounded-2xl cursor-pointer text-zinc-400">
                    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"/><path d="M16 10a4 4 0 0 1-8 0"/></svg>
                    <span class="font-bold text-sm">Commandes</span>
                </div>
                <div onclick="navigate('admin-finance')" class="nav-btn sidebar-item flex items-center space-x-3 px-4 py-3 rounded-2xl cursor-pointer text-zinc-400">
                    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                    <span class="font-bold text-sm">Comptabilité</span>
                </div>
                <div onclick="navigate('admin-menu')" class="nav-btn sidebar-item flex items-center space-x-3 px-4 py-3 rounded-2xl cursor-pointer text-zinc-400">
                    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4Z"/></svg>
                    <span class="font-bold text-sm">Editer Menu</span>
                </div>
            `;
            navigate('admin-dash');
        } else {
            userName.innerText = "Client Privilège";
            userLabel.innerText = "Visiteur";
            userAvatar.src = "https://api.dicebear.com/7.x/avataaars/svg?seed=Felix";
            mobileBtn.classList.remove('hidden');
            nav.innerHTML = `
                <div onclick="navigate('visitor-home')" class="nav-btn sidebar-item flex items-center space-x-3 px-4 py-3 rounded-2xl cursor-pointer text-zinc-400">
                    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
                    <span class="font-bold text-sm">La Carte</span>
                </div>
                <div onclick="alert('Indisponible en démo')" class="nav-btn sidebar-item flex items-center space-x-3 px-4 py-3 rounded-2xl cursor-pointer text-zinc-400">
                    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                    <span class="font-bold text-sm">Mes Réservations</span>
                </div>
            `;
            navigate('visitor-home');
        }
        renderRightPanel();
    }

    function navigate(tab) {
        currentTab = tab;
        const display = document.getElementById('content-display');
        const title = document.getElementById('page-title');
        
        // Update Nav UI
        document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
        const idxMap = { 'admin-dash': 0, 'admin-inv': 1, 'admin-orders': 2, 'admin-finance': 3, 'admin-menu': 4, 'visitor-home': 0 };
        document.querySelectorAll('.nav-btn')[idxMap[tab]]?.classList.add('active');

        if(window.innerWidth < 1024) toggleSidebar(false);

        switch(tab) {
            case 'admin-dash': 
                title.innerText = "Tableau de Bord";
                renderAdminDash(display); break;
            case 'admin-inv': 
                title.innerText = "Inventaire";
                renderAdminInv(display); break;
            case 'admin-orders': 
                title.innerText = "Suivi Commandes";
                renderAdminOrders(display); break;
            case 'admin-finance': 
                title.innerText = "Comptabilité";
                renderAdminFinance(display); break;
            case 'admin-menu': 
                title.innerText = "Editer Menu";
                renderAdminMenuEdit(display); break;
            case 'visitor-home': 
                title.innerText = "Menu Gastronomique";
                renderVisitorHome(display); break;
        }
    }

    // --- RENDERERS ---

    function renderVisitorHome(container) {
        container.innerHTML = `
            <div class="flex space-x-3 mb-10 overflow-x-auto pb-4 custom-scrollbar no-scrollbar">
                ${['all', 'repas', 'boisson', 'dessert'].map(cat => `
                    <button onclick="setCategory('${cat}')" class="px-6 py-3 rounded-2xl font-bold transition-all whitespace-nowrap ${currentCategory === cat ? 'bg-rose-600 text-white shadow-lg shadow-rose-600/30' : 'bg-zinc-900 text-zinc-500 hover:text-white'}">
                        ${cat === 'all' ? 'Tout' : cat.charAt(0).toUpperCase() + cat.slice(1) + 's'}
                    </button>
                `).join('')}
            </div>
            <div id="product-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3 gap-8">
                <!-- Products -->
            </div>
        `;
        updateProductGrid();
    }

    function updateProductGrid() {
        const grid = document.getElementById('product-grid');
        if(!grid) return;

        const filtered = menuData.filter(p => {
            const matchCat = currentCategory === 'all' || p.type === currentCategory;
            const matchSearch = p.name.toLowerCase().includes(searchQuery.toLowerCase());
            return matchCat && matchSearch;
        });

        grid.innerHTML = filtered.map(p => `
            <div class="product-card glass p-5 rounded-[2.5rem] flex flex-col relative group">
                <div class="h-48 w-full rounded-3xl overflow-hidden mb-5 relative bg-zinc-800">
                    <img src="${p.image}" class="w-full h-full object-cover" alt="${p.name}">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div>
                    <div class="absolute bottom-4 left-4">
                        <span class="bg-rose-600 text-white text-[10px] font-black uppercase px-2 py-1 rounded-md tracking-widest">${p.type}</span>
                    </div>
                </div>
                <div class="flex-1">
                    <div class="flex justify-between items-start mb-2">
                        <h3 class="text-lg font-bold text-white group-hover:text-rose-500 transition-colors">${p.name}</h3>
                        <span class="text-rose-500 font-black text-lg">$${p.price.toFixed(2)}</span>
                    </div>
                    <p class="text-zinc-500 text-xs leading-relaxed mb-6 line-clamp-2">${p.desc}</p>
                </div>
                <button onclick="addToCart(${p.id})" class="w-full bg-zinc-900 hover:bg-rose-600 text-white py-4 rounded-2xl font-bold flex items-center justify-center transition-all group-hover:shadow-lg group-hover:shadow-rose-600/20">
                    <svg class="mr-2" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                    Ajouter
                </button>
            </div>
        `).join('');
    }

    function renderAdminDash(container) {
        container.innerHTML = `
            <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6 mb-10">
                <div class="glass p-8 rounded-[2.5rem] border-l-4 border-rose-500 shadow-xl">
                    <p class="text-zinc-500 text-xs font-bold uppercase tracking-widest mb-2">Chiffre d'Affaire</p>
                    <h3 class="text-3xl font-black text-white">$14,280.50</h3>
                </div>
                <div class="glass p-8 rounded-[2.5rem] border-l-4 border-emerald-500 shadow-xl">
                    <p class="text-zinc-500 text-xs font-bold uppercase tracking-widest mb-2">Commandes</p>
                    <h3 class="text-3xl font-black text-white">342</h3>
                </div>
                <div class="glass p-8 rounded-[2.5rem] border-l-4 border-blue-500 shadow-xl">
                    <p class="text-zinc-500 text-xs font-bold uppercase tracking-widest mb-2">Satisfation</p>
                    <h3 class="text-3xl font-black text-white">4.9/5</h3>
                </div>
                <div class="glass p-8 rounded-[2.5rem] border-l-4 border-amber-500 shadow-xl">
                    <p class="text-zinc-500 text-xs font-bold uppercase tracking-widest mb-2">Personnel</p>
                    <h3 class="text-3xl font-black text-white">12</h3>
                </div>
            </div>

            <div class="glass rounded-[2.5rem] overflow-hidden border border-zinc-800 shadow-2xl mb-10">
                <div class="px-8 py-6 border-b border-zinc-800 flex justify-between items-center bg-zinc-900/30">
                    <h3 class="font-bold text-white uppercase tracking-widest text-xs">Dernières Opérations</h3>
                    <button class="text-rose-500 font-bold text-xs uppercase hover:underline">Imprimer Rapport</button>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full text-left text-sm">
                        <thead class="text-zinc-500 border-b border-zinc-800">
                            <tr>
                                <th class="px-8 py-4 font-bold uppercase text-[10px]">Client</th>
                                <th class="px-8 py-4 font-bold uppercase text-[10px]">Date</th>
                                <th class="px-8 py-4 font-bold uppercase text-[10px]">Montant</th>
                                <th class="px-8 py-4 font-bold uppercase text-[10px]">Statut</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-zinc-900">
                            <tr>
                                <td class="px-8 py-6 font-bold text-white">Marc-Antoine</td>
                                <td class="px-8 py-6 text-zinc-500 italic">Il y a 2 min</td>
                                <td class="px-8 py-6 font-black text-rose-500">$72.00</td>
                                <td class="px-8 py-6"><span class="bg-emerald-500/10 text-emerald-500 text-[10px] font-black px-3 py-1 rounded-full uppercase">Complet</span></td>
                            </tr>
                            <tr>
                                <td class="px-8 py-6 font-bold text-white">Léa Dupont</td>
                                <td class="px-8 py-6 text-zinc-500 italic">Il y a 14 min</td>
                                <td class="px-8 py-6 font-black text-rose-500">$34.50</td>
                                <td class="px-8 py-6"><span class="bg-blue-500/10 text-blue-500 text-[10px] font-black px-3 py-1 rounded-full uppercase">Prêt</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        `;
    }

    function renderAdminInv(container) {
        container.innerHTML = `
            <div class="glass rounded-[2.5rem] overflow-hidden border border-zinc-800">
                <div class="overflow-x-auto">
                    <table class="w-full text-left">
                        <thead class="bg-zinc-900/50 text-zinc-500 text-[10px] font-black uppercase border-b border-zinc-800">
                            <tr>
                                <th class="px-8 py-5">Désignation</th>
                                <th class="px-8 py-5 text-center">En Stock</th>
                                <th class="px-8 py-5">Niveau</th>
                                <th class="px-8 py-5">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-zinc-900">
                            ${menuData.map(item => {
                                let label = "Correct"; let c = "emerald";
                                if(item.stock < 10) { label="Critique"; c="rose"; }
                                else if(item.stock < 20) { label="Bas"; c="amber"; }
                                return `
                                    <tr class="hover:bg-zinc-900/20 transition-colors">
                                        <td class="px-8 py-6 flex items-center space-x-4">
                                            <img src="${item.image}" class="w-12 h-12 rounded-2xl object-cover shadow-lg">
                                            <span class="font-bold text-white">${item.name}</span>
                                        </td>
                                        <td class="px-8 py-6 text-center font-black text-xl">${item.stock}</td>
                                        <td class="px-8 py-6">
                                            <div class="flex items-center">
                                                <div class="w-2 h-2 rounded-full bg-${c}-500 mr-2 shadow-[0_0_8px] shadow-${c}-500"></div>
                                                <span class="text-${c}-500 font-bold text-xs uppercase">${label}</span>
                                            </div>
                                        </td>
                                        <td class="px-8 py-6">
                                            <button onclick="restock(${item.id})" class="text-zinc-600 hover:text-white transition-colors"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 4v6h-6M1 20v-6h6"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg></button>
                                        </td>
                                    </tr>
                                `;
                            }).join('')}
                        </tbody>
                    </table>
                </div>
            </div>
        `;
    }

    function renderAdminOrders(container) {
        container.innerHTML = `
            <div class="grid grid-cols-1 xl:grid-cols-2 gap-10">
                <div class="space-y-6">
                    <h3 class="flex items-center text-rose-500 font-black uppercase tracking-[0.2em] text-xs px-2">
                        <span class="w-3 h-3 bg-rose-500 rounded-full mr-3 animate-pulse shadow-[0_0_10px_rgba(225,29,72,0.8)]"></span>
                        Cuisines - En Cours
                    </h3>
                    ${orders.filter(o => o.status === 'en cours').map(o => `
                        <div class="glass p-8 rounded-[2.5rem] border-l-4 border-rose-500 shadow-2xl relative overflow-hidden group">
                            <div class="flex justify-between items-start mb-4 relative z-10">
                                <div>
                                    <span class="text-[10px] font-black text-zinc-600 bg-zinc-900 px-3 py-1 rounded-full uppercase mb-2 block">${o.id} • ${o.time}</span>
                                    <h4 class="text-xl font-black text-white">${o.customer}</h4>
                                </div>
                                <span class="text-2xl font-black text-rose-500">$${o.total.toFixed(2)}</span>
                            </div>
                            <p class="text-zinc-400 text-sm italic mb-8 relative z-10">${o.items}</p>
                            <button onclick="finishOrder('${o.id}')" class="w-full bg-emerald-600 hover:bg-emerald-700 text-white font-black py-4 rounded-2xl transition-all shadow-lg shadow-emerald-900/20 active:scale-95">Finaliser la préparation</button>
                        </div>
                    `).join('')}
                </div>
                <div class="space-y-6">
                    <h3 class="flex items-center text-zinc-500 font-black uppercase tracking-[0.2em] text-xs px-2">Historique - Terminé</h3>
                    <div class="opacity-60 space-y-4">
                        ${orders.filter(o => o.status === 'terminé').map(o => `
                            <div class="glass p-6 rounded-[2.5rem] border-l-4 border-zinc-700">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-[10px] font-bold text-zinc-600">${o.id}</span>
                                    <span class="text-zinc-400 font-bold">$${o.total.toFixed(2)}</span>
                                </div>
                                <h4 class="font-bold text-white">${o.customer}</h4>
                                <p class="text-zinc-600 text-xs">${o.items}</p>
                            </div>
                        `).join('')}
                    </div>
                </div>
            </div>
        `;
    }

    function renderAdminFinance(container) {
        container.innerHTML = `
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-10 mb-10">
                <div class="glass p-10 rounded-[3rem] shadow-2xl bg-gradient-to-br from-zinc-900 to-[#0F0F11]">
                    <p class="text-zinc-500 font-bold uppercase tracking-widest text-xs mb-4">Balance d'Exploitation</p>
                    <h3 class="text-6xl font-black text-white mb-8">$52,490.00</h3>
                    <div class="flex space-x-6">
                        <div class="bg-emerald-500/10 p-4 rounded-3xl flex-1">
                            <p class="text-emerald-500 text-[10px] font-black uppercase">Revenus</p>
                            <p class="text-xl font-bold text-white">+$64.2k</p>
                        </div>
                        <div class="bg-rose-500/10 p-4 rounded-3xl flex-1">
                            <p class="text-rose-500 text-[10px] font-black uppercase">Dépenses</p>
                            <p class="text-xl font-bold text-white">-$11.7k</p>
                        </div>
                    </div>
                </div>
                <div class="glass p-10 rounded-[3rem] flex flex-col justify-center">
                    <h4 class="font-black text-zinc-500 uppercase text-xs mb-8 tracking-widest">Répartition des Ventes</h4>
                    <div class="space-y-6">
                        ${['Repas', 'Boissons', 'Desserts'].map((cat, i) => `
                            <div>
                                <div class="flex justify-between text-xs font-black uppercase mb-2">
                                    <span class="text-zinc-400">${cat}</span>
                                    <span class="text-white">${[68, 22, 10][i]}%</span>
                                </div>
                                <div class="h-1.5 bg-zinc-800 rounded-full">
                                    <div class="h-full bg-rose-600 rounded-full" style="width: ${[68, 22, 10][i]}%"></div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            </div>
        `;
    }

    function renderAdminMenuEdit(container) {
        container.innerHTML = `
            <div class="flex flex-col sm:flex-row justify-between items-center mb-10 gap-4">
                <p class="text-zinc-500 text-sm font-medium italic">Gestion dynamique des actifs culinaires.</p>
                <button onclick="alert('Fonctionnalité de création de fiche disponible en V2')" class="bg-rose-600 hover:bg-rose-700 text-white px-8 py-4 rounded-2xl font-black text-xs uppercase shadow-xl shadow-rose-900/30 transition-all">+ Nouveau Produit</button>
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-8">
                ${menuData.map(item => `
                    <div class="glass p-6 rounded-[2.5rem] group relative">
                        <div class="h-40 w-full rounded-2xl overflow-hidden mb-6 relative">
                            <img src="${item.image}" class="w-full h-full object-cover">
                            <div class="absolute inset-0 bg-black/40 hidden group-hover:flex items-center justify-center transition-all">
                                <button class="bg-white/10 backdrop-blur-md p-3 rounded-full text-white hover:bg-white/30"><svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/></svg></button>
                            </div>
                        </div>
                        <h4 class="text-white font-black text-lg mb-4 truncate">${item.name}</h4>
                        <div class="flex items-center justify-between">
                            <div class="bg-zinc-900 px-4 py-2 rounded-xl text-rose-500 font-black text-sm">$${item.price.toFixed(2)}</div>
                            <div class="flex space-x-2">
                                <button class="w-10 h-10 flex items-center justify-center bg-zinc-900 text-emerald-500 rounded-xl hover:bg-emerald-600 hover:text-white transition-all"><svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg></button>
                                <button onclick="deleteItem(${item.id})" class="w-10 h-10 flex items-center justify-center bg-zinc-900 text-rose-500 rounded-xl hover:bg-rose-600 hover:text-white transition-all"><svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg></button>
                            </div>
                        </div>
                    </div>
                `).join('')}
            </div>
        `;
    }

    // --- ACTIONS ---

    function setCategory(cat) {
        currentCategory = cat;
        renderVisitorHome(document.getElementById('content-display'));
    }

    function searchItems(val) {
        searchQuery = val;
        if(currentTab === 'visitor-home') updateProductGrid();
    }

    function addToCart(id) {
        const item = menuData.find(i => i.id === id);
        if(item.stock <= 0) return alert("Rupture de stock !");
        
        cart.push({...item});
        renderRightPanel();
        updateMobileCartUI();
        
        // Petite animation de feedback
        const btn = document.getElementById('cart-count-badge');
        btn.classList.add('scale-125');
        setTimeout(() => btn.classList.remove('scale-125'), 200);
    }

    function removeFromCart(idx) {
        cart.splice(idx, 1);
        renderRightPanel();
        updateMobileCartUI();
    }

    function finishOrder(id) {
        const o = orders.find(x => x.id === id);
        if(o) o.status = 'terminé';
        navigate('admin-orders');
        renderRightPanel();
    }

    function restock(id) {
        const i = menuData.find(x => x.id === id);
        if(i) i.stock += 10;
        navigate('admin-inv');
    }

    function deleteItem(id) {
        if(!confirm("Supprimer définitivement du menu ?")) return;
        const idx = menuData.findIndex(x => x.id === id);
        menuData.splice(idx, 1);
        navigate('admin-menu');
    }

    function confirmOrder() {
        if(cart.length === 0) return;
        const total = cart.reduce((a, b) => a + b.price, 0);
        
        // Simuler ajout aux commandes admin
        const newId = "#OP-" + Math.floor(1000 + Math.random() * 9000);
        orders.unshift({
            id: newId,
            customer: "Client Anonyme",
            items: cart.map(i => i.name).join(', '),
            total: total,
            status: 'en cours',
            time: new Date().toLocaleTimeString([], {hour: '2min', minute: '2min'})
        });

        // Simuler déduction stock
        cart.forEach(item => {
            const m = menuData.find(x => x.id === item.id);
            if(m) m.stock--;
        });

        alert("Votre commande " + newId + " a été envoyée en cuisine !");
        cart = [];
        renderRightPanel();
        updateMobileCartUI();
        if(window.innerWidth < 1024) toggleMobileCart();
    }

    // --- PANEL RENDERERS ---

    function renderRightPanel() {
        const panel = document.getElementById('right-panel');
        if(!panel) return;

        if (currentUser === 'visitor') {
            const total = cart.reduce((acc, curr) => acc + curr.price, 0);
            panel.innerHTML = `
                <div class="h-full flex flex-col">
                    <h3 class="text-xl font-bold text-white mb-8 flex items-center">
                        Mon Panier 
                        <span class="ml-3 bg-rose-600 text-white text-[10px] w-5 h-5 rounded-full flex items-center justify-center font-black">${cart.length}</span>
                    </h3>
                    <div class="flex-1 overflow-y-auto custom-scrollbar space-y-4 pr-2">
                        ${cart.length === 0 ? `
                            <div class="text-center py-20">
                                <div class="text-zinc-800 mb-4 inline-block"><svg width="48" height="48" fill="none" stroke="currentColor" stroke-width="1"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg></div>
                                <p class="text-zinc-600 text-xs uppercase tracking-widest font-bold">Votre panier est vide</p>
                            </div>
                        ` : cart.map((item, idx) => `
                            <div class="flex items-center space-x-4 bg-zinc-900/50 p-4 rounded-[1.5rem] border border-zinc-800 hover:border-zinc-700 transition-all group">
                                <img src="${item.image}" class="w-12 h-12 rounded-xl object-cover">
                                <div class="flex-1 min-w-0">
                                    <p class="text-sm font-bold text-white truncate">${item.name}</p>
                                    <p class="text-rose-500 font-black text-xs">$${item.price.toFixed(2)}</p>
                                </div>
                                <button onclick="removeFromCart(${idx})" class="text-zinc-700 hover:text-rose-500"><svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M18 6L6 18M6 6l12 12"/></svg></button>
                            </div>
                        `).join('')}
                    </div>
                    <div class="pt-8 border-t border-zinc-800 mt-6">
                        <div class="flex justify-between items-end mb-6">
                            <span class="text-zinc-500 text-xs font-black uppercase">Total</span>
                            <span class="text-3xl font-black text-white">$${total.toFixed(2)}</span>
                        </div>
                        <button onclick="confirmOrder()" class="w-full bg-rose-600 hover:bg-rose-700 text-white font-black py-5 rounded-2xl shadow-xl shadow-rose-900/20 transform transition active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed" ${cart.length === 0 ? 'disabled' : ''}>
                            CONFIRMER LA COMMANDE
                        </button>
                    </div>
                </div>
            `;
        } else {
            panel.innerHTML = `
                <div class="flex flex-col h-full">
                    <h3 class="text-xl font-bold text-white mb-8">Performance</h3>
                    <div class="space-y-6 flex-1 overflow-y-auto custom-scrollbar pr-2">
                        <div class="bg-gradient-to-br from-rose-600 to-rose-700 p-8 rounded-[2.5rem] shadow-xl text-white">
                            <p class="text-[10px] font-black uppercase tracking-[0.2em] mb-2 opacity-80">Commandes Actives</p>
                            <h4 class="text-5xl font-black">${orders.filter(o=>o.status==='en cours').length}</h4>
                        </div>
                        
                        <div class="bg-zinc-900/50 border border-zinc-800 p-6 rounded-[2rem]">
                            <h5 class="text-zinc-500 text-[10px] font-black uppercase mb-4 tracking-widest">Plats Populaires</h5>
                            <div class="space-y-4">
                                <div class="flex items-center justify-between">
                                    <span class="text-xs font-bold text-white">Burger Opulence</span>
                                    <span class="text-xs text-rose-500 font-black">42 vds</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-xs font-bold text-white">Pizza Royale</span>
                                    <span class="text-xs text-rose-500 font-black">28 vds</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
    }

    // --- UI HELPERS ---

    function toggleSidebar(show = null) {
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('sidebar-overlay');
        const isShowing = show !== null ? !show : sidebar.classList.contains('mobile-sidebar-show');
        
        if(!isShowing) {
            sidebar.classList.add('mobile-sidebar-show');
            sidebar.classList.remove('mobile-sidebar-hidden');
            overlay.classList.remove('hidden');
        } else {
            sidebar.classList.remove('mobile-sidebar-show');
            sidebar.classList.add('mobile-sidebar-hidden');
            overlay.classList.add('hidden');
        }
    }

    function toggleMobileCart() {
        const drawer = document.getElementById('mobile-cart-drawer');
        const isShowing = !drawer.classList.contains('translate-x-full');
        if(!isShowing) {
            drawer.classList.remove('translate-x-full');
            updateMobileCartUI();
        } else {
            drawer.classList.add('translate-x-full');
        }
    }

    function updateMobileCartUI() {
        const count = document.getElementById('cart-count-badge');
        const list = document.getElementById('mobile-cart-list');
        const footer = document.getElementById('mobile-cart-footer');
        
        count.innerText = cart.length;

        if (cart.length === 0) {
            list.innerHTML = `<p class="text-center text-zinc-600 mt-20">Panier vide</p>`;
            footer.innerHTML = "";
        } else {
            list.innerHTML = cart.map((item, idx) => `
                <div class="flex items-center space-x-4 bg-zinc-900/50 p-4 rounded-2xl border border-zinc-800">
                    <img src="${item.image}" class="w-10 h-10 rounded-xl object-cover">
                    <div class="flex-1">
                        <p class="text-sm font-bold text-white">${item.name}</p>
                        <p class="text-rose-500 text-xs">$${item.price.toFixed(2)}</p>
                    </div>
                    <button onclick="removeFromCart(${idx})" class="text-zinc-600"><svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg></button>
                </div>
            `).join('');

            const total = cart.reduce((a, b) => a + b.price, 0);
            footer.innerHTML = `
                <div class="flex justify-between items-center mb-6">
                    <span class="text-zinc-500 text-xs font-black uppercase">Total</span>
                    <span class="text-2xl font-black text-white">$${total.toFixed(2)}</span>
                </div>
                <button onclick="confirmOrder()" class="w-full bg-rose-600 text-white font-black py-4 rounded-xl shadow-lg">COMMANDER</button>
            `;
        }
    }

    // --- INIT ---
    window.addEventListener('resize', () => {
        if(window.innerWidth >= 1024) toggleSidebar(false);
    });

</script>
</body>
</html>

